<nav class="navbar navbar-expand-lg sticky-top bg-white border-bottom shadow-sm py-2">
  <div class="container-fluid px-4">
    <a class="navbar-brand d-flex align-items-center gap-2" [routerLink]="['/']">
      <div class="brand-logo">
        <i class="bi bi-ticket-detailed-fill "></i>
      </div>
      <span class="fw-bold tracking-tight">TicketSystem</span>
    </a>

    <div class="d-flex align-items-center ms-auto gap-3">

      <ng-container *ngIf="!hasLoggedIn()">
        <a class="nav-link fw-semibold text-secondary px-3 d-none d-md-block" [routerLink]="['/']">Home</a>
        <a class="btn btn-link text-decoration-none fw-semibold text-dark px-3" [routerLink]="['/auth/login']">Login</a>
        <a class="btn btn-primary px-4 fw-semibold rounded-pill shadow-sm" [routerLink]="['/auth/register']">Sign Up</a>
      </ng-container>

      <ng-container *ngIf="hasLoggedIn()">




        <div class="dropdown">
          <button class="btn position-relative" data-bs-toggle="dropdown" type="button">
            <i class="bi bi-bell fs-4"></i>
            <span *ngIf="notificationHistory().length > 0 && !isNavbarCleared()"
              class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
              {{ notificationHistory().length }}
            </span>
          </button>

          <ul class="dropdown-menu dropdown-menu-end shadow border-0 mt-3" style="width: 320px;">
            <li class="p-2 border-bottom d-flex justify-content-between align-items-center bg-light">
              <small class="fw-bold text-uppercase text-muted px-2">Recent</small>
              <button *ngIf="displayNotifications().length > 0"
                class="btn btn-sm text-danger border-0 py-0 fw-bold shadow-none"
                (click)="$event.stopPropagation(); clearNavbarView()">
                Clear
              </button>
            </li>

            <div style="max-height: 300px; overflow-y: auto;">
              <li *ngFor="let note of displayNotifications()">
                <a class="dropdown-item dropdown-item-1 py-2 border-bottom">
                  <div class="fw-bold small text-primary">{{ note.subject }}</div>
                  <div class="text-truncate text-muted small">{{ note.body }}</div>
                </a>
              </li>

              <li *ngIf="displayNotifications().length === 0" class="p-4 text-center text-muted">
                <i class="bi bi-check2-circle fs-2 d-block mb-2 text-success opacity-50"></i>
                <small>No recent notifications</small>
              </li>
            </div>

            <li class="text-center p-2 border-top">
              <a [routerLink]="['/notifications']" class="small text-primary text-decoration-none fw-bold">
                View All History
              </a>
            </li>
          </ul>
        </div>
        <div class="dropdown">
          <button class="btn user-avatar-btn dropdown-toggle shadow-sm" type="button" id="userMenu"
            data-bs-toggle="dropdown" aria-expanded="false">
            {{ firstLetter }}
          </button>
          <ul class="dropdown-menu dropdown-menu-end shadow border-0 mt-2" aria-labelledby="userMenu">
            <li class="px-3 py-2 border-bottom mb-1">
              <small class="text-muted d-block">Signed in as</small>
              <strong class="text-dark">{{ username() | titlecase }}</strong>
            </li>
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2 py-2" [routerLink]="['/auth/profile']">
                <i class="bi bi-person-circle"></i> Profile
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>
            <li>
              <button class="dropdown-item d-flex align-items-center gap-2 py-2 text-danger" (click)="logout()">
                <i class="bi bi-box-arrow-right"></i> Logout
              </button>
            </li>
          </ul>
        </div>

      </ng-container>
    </div>
  </div>
</nav>